/*! hm.js v1.0.0 Â© Fred Yang - semanticsworks.com | www.opensource.org/licenses/mit-license.php */(function(g,E,p){function gb(d,a){for(var b in a)d[b]||(d[b]=a[b])}function Ub(d){return"."===d?"#":(new Ia(d.length+2)).join("#")}function hb(d){if(d===F)return"";var a=ib.exec(d);return a?a[1].replace(Ja,Ka):d}function Ka(d){return"#"==d?".":(new Ia(d.length)).join("#")}function La(d,a,b){var c,e=d.lastIndexOf(".");l(b)&&(b=!0);if(b){-1===e?(b="",c=d):(b=d.substring(0,e),c=d.substring(e+1));e=b;b=c;for(var f=0;f<$.length;f++)$[f](e,b,a)}if(!ma(a))for(c in a){e=d;b=c;for(var f=a[c],k=0;k<$.length;k++)$[k](e,
b,f);La(d+"."+c,a[c],!1)}}function jb(d,a){a=G(a);var b=Q[a];b||(Q[a]=b=[]);b.pushUnique(d)}function kb(d,a){a=G(a);var b=Q[a];b.remove(d);b.length||delete Q[a]}function lb(d){return(d=Vb.exec(d))&&d[1]||""}function aa(){return!1}function H(){return!0}function va(d,a,b,c,e){this.publisher=K(d);this.originalPublisher=K(a);this.originalType=this.type=b;this.proposed=c;this.removed=e}function mb(d){var a=d.handler,b=a.getName,a=a.getParas;d=d.publisher;return a?d[b](a):q(d[b])?d[b]():d[b]}function nb(d,
a){var b=a.handler,c=b.setName;(b=b.setParas)?this[c](b,d):q(this[c])?this[c](d):this[c]=d}function ob(d,a,b){var c=ba.getId(a);return g.map(d.split(ca),function(a){return n(b)?a+"."+F+"."+c+"."+b:a+"."+F+"."+c+"."+ba.getId(b)}).join(" ")}function K(d){if(n(d))return h(d);if(t(d)&&!d.nodeType)return d;if(!l(d))return g(d)}function Wb(d){return"."==d?"\\.":".*"}function pb(d){var a,b,c;c=d.publisher.subsToMe();for(b=0;b<c.length;b++){a=c[b];var e=d,f;a:{f=a.eventTypes;var k=d.type,g=void 0,v=void 0,
h=v=g=void 0,j=void 0;if("*"===f)f="*";else{f=f.split(ca);for(j=0;j<f.length;j++)if(v=f[j],v=(h=qb.test(v))?v.replace(qb,""):v,v=v.replace(Xb,Wb),v=h?"^"+v:"^"+v+"$",g=new R(v,"i"),g=g.test(k))if(h){if(h="^"==v?k:R.rightContext,!h||!h.contains(".")){f=f[j];break a}}else{f=f[j];break a}f=void 0}}e.matchedType=f;d.matchedType&&wa(K(a.subscriber),a.handler,d);if(d.isImmediatePropagationStopped())return}if(!d.isCascadeStopped()&&(a=Q[d.publisher.path]))for(c=0;c<a.length;c++){b=u(a[c],d.originalPublisher.path,
d.type);if(b.isImmediatePropagationStopped()||b.isImmediatePropagationStopped())break;b.hasError()&&d.error()}}function wa(d,a,b,c){var e;b.handler=a;b.subscriber=d;c=l(c)?a.get.call(d,b):a.get.apply(d,[b].concat(c));if(!b.isAborted())if(na(c))e=m(!0,{},b),c.done(function(c){a.convert&&(c=a.convert.call(d,c,b));if(a.set||a.finalize)if(na(c))c.done(function(b){xa(d,a,b,e)});else return xa(d,a,c,b)});else if(a.convert&&(c=a.convert.call(d,c,b)),a.set||a.finalize)na(c)?(e=m(!0,{},b),c.done(function(b){xa(d,
a,b,e)})):xa(d,a,c,b)}function xa(d,a,b,c){b===da&&(b=p);a.set&&a.set.call(d,b,c);a.finalize&&a.finalize.call(d,b,c)}function rb(){this.isAborted=H}function ea(d){d.publisher=K(d.currentTarget);d.originalPublisher=K(d.target);d.isAborted=aa;d.abort=rb;var a=K(d.data.subscriber),b=d.data.handler;delete d.data;1<arguments.length?wa(a,b,d,x.call(arguments,1)):wa(a,b,d)}function sb(d,a,b,c){d=d||"";if(n(d)){var e=d,f=e.split(ca),k;if(1==f.length)if(e.startsWith("*")){d=W[e.substr(1)];if(!d)throw"common workflow "+
e+" does not exist";d=m({},d)}else if(e.startsWith("#"))if(d=Ma(e,a,b),q(d))d=m({get:d,options:c},d);else if(t(d)&&d.get)d=m({options:c},d);else throw"missing handler";else if(!l(a)&&!l(b))if(d=n(a),f=n(b),d)d={get:"get",set:e||"set"};else if(f)if(e)d={get:e,set:"set"};else if(d=s.raw(b),q(d))d={get:s.raw(b)};else{if(!t(d)||!d.get)throw"missing handler";}else d={get:e,set:e};else throw"invalid handler";else{d={};for(var g=0;g<ya.length;g++)e=f[g],k=ya[g],e&&("_"!==e&&"null"!=e)&&(d[k]=e)}}else if(q(d))d=
m({get:d,options:c},d);else if(t(d)&&d.get)d=m({options:c},d);else throw"invalid workflow expression";f=d;e=f.initialize;if(n(e))if(e.startsWith("*")){if(e=h.activity.initialize[e.substring(1)],!e)throw"initialize activity does not exist!";}else{var v=e;if(!s.raw(v))throw"initialize activity does not exist at path "+v;e=function(a,b,c,d){s.set(v,a,b,c,d)}}e?e(K(a),K(b),f,c):l(c)||(f.options=c);za("get",d,a,b);za("set",d,a,b);oa("convert",d,a,b);oa("finalize",d,a,b);return d}function Ma(d,a,b){d=d.substr(1);
d=n(b)?A(b,d):n(a)?A(a,d):d;return s.raw(d)}function tb(d){var a;if(n(d)){var b=d.split(ca),c;if(1<b.length){d={};for(var e=0;e<ya.length;e++)a=b[e],c=ya[e],a&&("_"!==a&&"null"!=a)&&(d[c]=a)}else throw"invalid workflow type";a=d}else if(q(d)||t(d)&&d.get)a=d,q(d)&&(a=m({get:d},a));else throw"invalid workflow expression";oa("initialize",a);za("get",a);za("set",a);oa("convert",a);oa("finalize",a);return a}function za(d,a,b,c){var e=a[d];if(e&&n(e)){var f=h.activity[d];if(e.startsWith("*")){if(e=e.substr(1),
a[d]=f[e],!a[d])throw e+" does not exists "+d+" Activity";}else if(e.startsWith("#"))a[d]=Ma(e,b,c);else if(e=e.split("*"),a[d]="get"==d?mb:nb,a[d+"Name"]=e[0],e[1]&&(a[d+"Paras"]=e[1]),!l(b)&&!l(c)){a=e[0];b="get"==d?b:c;var k;n(b)?Na[a]||(k=!0):b.nodeType?fa[a]||(k=!0):a in b||(k=!0);if(k)throw("get"==d?"publisher":"subscriber")+" does not have a member "+a;}}}function oa(d,a,b,c){var e=a[d];if(n(e))if(e.startsWith("*")){if(a[d]=h.activity[d][e.substr(1)],!a[d])throw e+"Activity does not exists";
}else if(e.startsWith("#"))a[d]=Ma(e,b,c);else throw'activity other than "get" and "set"  must begin with "*" or "#" ';}function ub(d){if(t(d)){if(!ba.getId(d))return;ba.unMark(d)}B.removeBy(d)}function Oa(d,a){if("_"!==a)return a&&a.startsWith("_")?a.substr(1):d||a}function vb(d){if(1===d.nodeType){var a,b,c,e=d.attributes,f=e[L.subsAttr]&&e[L.subsAttr].nodeValue||"";for(a=0;a<e.length;a++)if(b=e[a],b.name!==L.subsAttr){c=b.name;c=c.replace(Yb,"");if(c.startsWith("!")||c.startsWith("$"))c=c.replace(Zb,
" ");c=c.replace($b,ac);if("ns"==c||ga[c])f=f+";"+c+":"+(b.nodeValue||"/");else if(c.startsWith("!")||c.startsWith("$")){b=b.nodeValue.split(";");for(var k=0;k<b.length;k++)f=f+";"+c+":"+b[k]}}d="tag_"+d.tagName;ga[d]&&(f=f+";"+d+":.");return f.replace(/^;/,"")}}function X(d,a,b,c){var e,f;if(d)if(d.nodeType){if(c=d,d=a||vb(c)){a=new X;a.elem=c;b=a;a:{for(c=g(c);(c=c.parent())&&c.length;)if(e=c.hmData("ns"),!l(e)){c=e;break a}c=""}b.ns=c;return new X(d,a)}}else{if(!a)return a=new X,a.elem={},new X(d,
a);this.sub=[];this.pub=[];for(this.bindings=[];f=bc.exec(d);){var k=f[1],r=g.trim(f[2]);f=g.trim(f[3]);k?this["$"==k?"pub":"sub"].push({eventTypes:r,value:f}):"ns"==r?e=f:this.bindings.push({bindingName:r,value:f})}this.ns=A(A(a.ns,b),e);this.text=d;this.elem=a.elem;a.context?this.context=a.context:(this.context=this,this.dynamicBindings=[],this.subscriptions=[],g(this.elem).hmData("ns",this.ns));this.options=Oa(a.options,c);this._importBindings();this._importSubscriptions("sub");this._importSubscriptions("pub")}else this.subscriptions=
[]}function Pa(d){var a,b,c=g(d);if(!c.hmData("parsed")&&(a=vb(d))){a=new X(d,a);d=a.subscriptions;if(b=a.runFirst)b[0](b[1],b[2],b[3],b[4]);var e=a.dynamicBindings;for(b=0;b<e.length;b++){var f=e[b];f[0](f[1],f[2],f[3],f[4])}if(a=a.runLast)a[0](a[1],a[2],a[3],a[4]);for(b=0;b<d.length;b++)a=d[b],h.sub(a.subscriber,a.publisher,a.eventTypes,a.handler,a.options,a.delegate);c.hmData("parsed",!0)}c.children().each(function(){Pa(this)})}function S(d,a,b){if(!d)return ga;if(!a){if(t(d)){for(var c in d)S(c,
d[c]);return this}return ga[d]}I(a)&&(a=a.concat(";"));ga[b?"tag_"+d.toUpperCase():d]=a;return this}function wb(d,a,b,c){s.get(a,d,a,b,c)}function Qa(d){return function(){for(var a=0;a<d.length;a++)d[a].apply(this,arguments)}}function xb(d,a){if(n(d)){if(a){for(var b=1,c=M(d);b<c.length;)J(c[b],c[b-1]),b++;d=c[c.length-1]}var e=d,b=[],c=M(e);if(1===c.length)b=yb(c[0]);else{for(var f=0;f<c.length;f++)b.push(yb(c[f]));b=g.when.apply(g,b)}return Aa(b).fail(function(){j.unload(e)})}if(I(d)){for(var b=
d,k=[],r,h={ok:!0},f=0;f<b.length;f++)r=b[f],k.push(r),c=0===f?xb(r).fail(zb(r,h)):c.nextLoad(r).fail(zb(k.slice(),h));return Aa(c)}throw"resource parameter should be an array or string";}function zb(d,a){return function(){a.ok&&(j.unload(d),a.ok=!1)}}function yb(d){var a=ha(d);if(a){var b=N(d);b||(b=a.load(d),a.noRefCount||N(d,b));"staticLoaded"!==b.refCount&&(b.refCount=b.refCount?b.refCount+1:1);return b}return j.load(Ba(d)+".loader").nextLoad(d)}function N(d,a){if(d===p)return O;if(a===p){if(1===
arguments.length)return O[d];delete O[d]}else return O[d]=a}function Aa(d){var a=g.Deferred();d.nextLoad=function(b){var c=x.call(arguments);d.then(function(){j.load.apply(null,c).then(function(){a.resolve.apply(a,x.call(arguments))},function(){a.reject(b)})},function(){a.reject(b)});return Aa(a.promise())};d.andLoad=function(){var a=j.apply(null,arguments);return Aa(g.when(a,d))};return d}function M(d){return d.replace(cc,"").split(dc)}function Ab(d){d=Bb.exec(d.toLowerCase());return!(!d||!(d[1]!=
Ca[1]||d[2]!=Ca[2]||(d[3]||("http:"===d[1]?80:443))!=(Ca[3]||("http:"===Ca[1]?80:443))))}function Da(d){Ra.href=ec.test(d)?d:Sa+d;Ab(d)?d=Ra.href:(d=Ra.href,d=pa(d),d=ia?d+(fc.test(d)?"&":"?")+qa+"="+ia:d);return d}function pa(d){return""===ia?d:d.replace(Cb,"")}function Db(d,a){var b=g.extend(!0,{},O);j.unload(d,!0);a&&a();return j.load(d).done(function(){for(var a in b)O[a]&&b[a]&&(O[a].refCount=b[a].refCount,O[a].url=b[a].url,O[a].assetId=b[a].assetId)})}function gc(d,a){if(d&&!a||a&&!d)return!0;
if(!d&&!a)return!1;d=M(d).sort();a=M(a).sort();if(d.length!=a.length)return!0;for(var b=0;b<d.length;b++)if(d[b]!=a[b])return!0;return!1}function ha(d){var a,b;for(b=Ta.length-1;0<=b&&!(a=Ta[b](d));b--);a=a||j.defaultLoader;return ra[a]}function Eb(d,a,b){return m({},Ua,t(d)?d:{get:d,set:a,finalize:b})}function Fb(d){this.modelPath=d.publisher.path;this.e=d}function Gb(d){d=d||C.defaultEngine;if(!d)throw"engine name is not specified or default engine name is null";d=Ea[d];if(!d)throw"engine '"+d+
"' can not be found.";return d}function Hb(d,a,b,c,e){a:{var f,k;if(c)for(f=ja.length-1;0<=f;f--){if(k=ja[f],k.name==c){c=k;break a}}else for(f=ja.length-1;0<=f;f--)if(k=ja[f],k.match&&k.match(a)){c=k;break a}c=void 0}if(!c||!c[e])throw"can not find "+e+" method for view";b[e+"ViewValue"]=c[e];c.convert&&(b.convert=c.convert);a.hmData("valueBound")||(c.initialize&&c.initialize(a,d.get()),a.parents("form").bind("reset",function(){T(function(){a.triggerHandler("resetVal")},10)}),a.hmData("valueBound",
!0))}var h=E.hm=function(d,a){return new Va(d,a)},Va=function(d,a){this.path=G(d||"",!0);l(a)||this.set(a)},ka=E.document,Wa=E.localStorage,T=E.setTimeout,hc=E.location,ic=E.alert,jc=E.confirm,Na,m=g.extend,Xa={},I=g.isArray,q=g.isFunction,kc={undefined:p,"boolean":p,number:p,string:p},F="__hm",ib=/^__hm\.([^\.]+?)(?:\.|$)/,lc=/this\.(?:get)\s*\(\s*(['"])([\*\.\w\/]+)\1\s*\)/g,Q={},L={},s,sa=Xa[F]={},mc=Xa.hasOwnProperty,Ia=E.Array,Ib=Ia.prototype,nc=String.prototype,x=Ib.slice,u,oc=/^(?:\{.*\}|\[.*\])$/,
pc=/^\.(\.*)([\.\*])/,qc=/^\.<(.*)/,Jb=/^[\.\*]/,rc=/[\.\*]/,sc=/#+|\./g,Ja=/#+/g,R=E.RegExp,Vb=/^(.+)[\.\*]\w+$/,A,tc=/^.+\.(\w+)$|\w+/,P,l,ma,n,t,Y,Ya=g.isNumeric,na,Fa,G,U,Kb,fa=g.fn,uc=/\{([^\{\}]*)\}/g;gb(Ib,{indexOf:function(d,a){for(var b=a||0;b<this.length;b++)if(this[b]==d)return b;return-1},contains:function(d){return-1!==this.indexOf(d)},remove:function(d){d=this.indexOf(d);-1!=d&&this.splice(d,1);return this},removeAt:function(d){this.splice(d,1);return this},pushUnique:function(d){this.contains(d)||
this.push(d);return this},merge:function(d){if(d&&d.length)for(var a=0;a<d.length;a++)this.pushUnique(d[a]);return this},sortObject:function(d,a){l(a)&&(l(d)?(a=!0,d=p):n(d)?a=!0:(a=d,d=p));d?this.sort(function(b,c){var e=b[d],f=c[d];return e==f?0:a?e>f?1:-1:e>f?-1:1}):a?this.sort():this.sort().reverse();return this}});gb(nc,{startsWith:function(d){return 0===this.indexOf(d)},contains:function(d){return-1!==this.indexOf(d)},endsWith:function(d){return-1!==this.indexOf(d,this.length-d.length)},supplant:function(d){return this.replace(uc,
function(a,b){var c=d[b];return typeof c?c:a})},format:function(){var d=this;g.each(arguments,function(a,b){d=d.replace(new R("\\{"+a+"\\}","g"),b)});return d}});Na=Va.prototype=h.fn=h.prototype={constructor:Va,toString:function(){return this.path},get:function(d){var a;if(a=this.accessor(d,!0)){if(q(a.hostObj))return a.hostObj.apply(this.cd(".."),x.call(arguments));a=!a.index?a.hostObj:a.hostObj[a.index];return q(a)?a.apply(this.cd(d).cd(".."),x.call(arguments,1)):a}},getJson:function(){return JSON.stringify(this.get.apply(this,
x.call(arguments)))},raw:function(d,a){var b;q(d)&&(a=d,d="");if(a)return b=this.accessor(d),b.index in b.hostObj?this.update(d,a,b):this.create(d,a,b);if(b=this.accessor(d,!0))return!b.index?b.hostObj:b.hostObj[b.index]},set:function(d,a,b){if(1==arguments.length){if(""===this.path)throw"root object can not changed";s.set(this.path,d,a);return this}var c=x.call(arguments);if(Y(d)){if(2==arguments.length)return s.set(d,this.path,a),this}else b=a,a=d,d=!1;var e=this.accessor(a),f=e.hostObj[e.index];
return q(f)?(f.apply(this.cd(a).cd(".."),x.call(c,1)),this):e.index in e.hostObj?this.update(d,a,b,e):this.create(d,a,b,e)},accessor:function(d,a){0===d&&(d="0");var b,c,e=Xa,f=this.getPath(d),k=G(f,!0),g=k.split(".");if(1===g.length)c=k;else{c=g[g.length-1];for(b=0;b<g.length-1&&!(e=e[g[b]],e===p);b++);}if(ma(e)){if(a)return;throw"invalid update on unreachable node '"+U(f)+"'";}return{physicalPath:k,hostObj:e,index:c}},create:function(d,a,b,c){Y(d)||(c=b,b=a,a=d,d=!1);c=c||this.accessor(a);a=c.physicalPath;
var e=c.hostObj,f=c.index,g=I(e);if(g&&Ya(f)){if(f>e.length)throw"you can not add item with hole in array";}else if(f in e)throw"value at path: '"+U(c.physicalPath)+"' has been defined, try use update method instead";if(!d&&u(a,a,"beforeCreate",b).hasError())return!1;g&&Ya(f)?f==e.length?e[f]=b:f<e.length&&e.splice(c.index,0,b):e[c.index]=b;La(a,b);u(a,a,"afterCreate",b);return this},extend:function(d,a){var b;a?b=this.cd(d):(a=d,b=this);for(var c in a)b.set(c,a[c]);return this},update:function(d,
a,b,c){if(1==arguments.length){if(""===this.path)throw"root object can not updated";s.update(this.path,d);return this}if(Y(d)){if(2==arguments.length)return s.update(d,this.path,a),this}else c=b,b=a,a=d,d=!1;c=c||this.accessor(a);if(!(c.index in c.hostObj))throw"value at path: '"+U(c.physicalPath)+"' has been not defined, try use create method instead";var e=c.physicalPath,f=c.hostObj[c.index];if(f==b)return this;if(!d&&u(e,e,"beforeUpdate",b,f).hasError())return!1;c.hostObj[c.index]=b;La(e,b);d||
u(e,e,"afterUpdate",b,f);return this},del:function(d){if(l(d)){if(this.path)return s.del(this.path);throw"root can not be deleted";}var a=this.accessor(d),b=a.hostObj;d=a.physicalPath;var c=b[a.index],e=I(b);if(u(d,d,"beforeDel",p,c).hasError())return!1;u(d,d,"duringDel",p,c);e?b.splice(a.index,1):delete b[a.index];for(a=0;a<Ga.length;a++)Ga[a](d,c);u(d,d,"afterDel",p,c);return c},createIfUndefined:function(d,a){if(l(a))throw"missing value argument";var b=this.accessor(d);return b.index in b.hostObj?
this:this.create(d,a,b)},toggle:function(d){var a=this.accessor(d);a.index in a.hostObj&&this.update(d,!a.hostObj[a.index],a);return this},pushStack:function(d){d.previous=this;return d},cd:function(d){return this.pushStack(h(this.getPath(d)))},parent:function(){return this.cd("..")},shadow:function(){return this.cd("*")},sibling:function(d){return this.cd(".."+d)},main:function(){return this.pushStack(h(hb(this.path)))},getPath:function(d){return A(this.path,d)},logicalPath:function(d){return U(this.getPath(d))},
physicalPath:function(d){return G(this.getPath(d))},pathContext:function(){return lb(this.path)},pathIndex:function(){var d=tc.exec(this.path);return d[1]||d[0]},invokeUnwrapped:function(d){if(0===arguments.length)throw"methodName is missing";var a=this.get();return a[d].apply(a,x.call(arguments,1))},indexOf:function(d){return this.get().indexOf(d)},contains:function(d){return-1!==this.indexOf(d)},first:function(d){return d?this.filter(d)[0]:this.get("0")},last:function(){var d=this.get();return d[d.length-
1]},push:function(d){for(var a=0;a<arguments.length;a++)this.create(this.get().length,arguments[a]);return this},pushUnique:function(d){return!this.contains(d)?this.push(d):this},pop:function(){return this.removeAt(this.get().length-1)},shift:function(){return this.del(0)},unshift:function(d){return this.create(0,d)},insertAt:function(d,a){return this.create(d,a)},updateAt:function(d,a){return this.update(d,a)},removeAt:function(d){return this.del(d)},move:function(d,a){var b=this.count();d!==a&&
(0<=d&&d<b&&0<=a&&a<b)&&(b=this.del(d),this.insertAt(a,b),u(this.path,this.path,"move",a,d));return this},replaceItem:function(d,a){if(d==a)return this;var b=this.indexOf(d);return-1!=b?this.updateAt(b,a):this},removeItem:function(d){d=this.indexOf(d);return-1!==d?this.removeAt(d):this},removeItems:function(d){for(var a=0;a<d.length;a++)this.removeItem(d[a]);return this},clear:function(){var d=this.get(),a=d.splice(0,d.length);u(this.path,this.path,"afterCreate",d,a);return this},count:function(){return this.get().length},
filter:function(d){return g(this.get()).filter(d).get()},each:function(d,a){Y(d)||(a=d,d=!1);var b,c,e,f;if(d){f=this.get();for(c=f.length-1;0<=c;c--)if(e=a.call(f[c],c,f[c],f),!0===e)b=!0;else if(!1===e)break;b&&this.change()}else for(c=this.count()-1;0<=c&&!(b=this.cd(c),!1===a.call(b,c,b,this));c--);return this},map:function(d){return g.map(this.get(),d)},sort:function(d,a){return u(this.path,this.path,"afterUpdate",this.get().sortObject(d,a))},watch:function(){for(var d=0;d<arguments.length;d++)jb(this.path,
arguments[d]);return this},unwatch:function(){for(var d=0;d<arguments.length;d++)kb(this.path,arguments[d]);return this},isEmpty:function(d){d=this.get(d);return!d?!0:!I(d)?!1:0===d.length},isShadow:function(){return this.path.startsWith(F)},toJSON:function(d){return JSON.stringify(this.get(d))},compare:function(d){if(d)if(d=Fa(d),n(d)){if(this.get()==d)return!0;try{return eval("this.get()"+d)}catch(a){return!1}}else return this.get()==d;else return this.isEmpty()},saveLocal:function(d){P.local(this.getPath(d),
this.get(d));return this},getLocal:function(d){return P.local(this.getPath(d))},restoreLocal:function(d){s.set(this.getPath(d),this.getLocal(d));return this},clearLocal:function(d){P.local(this.getPath(d),p);return this}};var $=[function(d,a,b){if(q(b)&&(!b.name||!b.name.startsWith("_"))){a=d?d+"."+a:a;var c=b.toString(),e;for(b=[];e=lc.exec(c);)b.pushUnique(e[2]);for(c=0;c<b.length;c++)jb(a,d?A(d,b[c]):b[c])}}],da={},Za=function a(b){var c;if(!(this instanceof a))return c=new a(da),a.apply(c,arguments);
if(arguments[0]===da)return this;this.initialize.apply(this,arguments);return this},la;m(Za.prototype,{callProto:function(a){return this.constructor.prototype[a].apply(this,x.call(arguments,1))},callBase:function(a){la=la||this;if(la=la.constructor.__super__){var b=la[a].apply(this,x.call(arguments,1));la=null;return b}},initialize:function(a){m(this,a)},toJSON:function(){var a=m(!0,{},this),b;for(b in a)b.startsWith("__")&&delete a[b];return a}});m(Za,{list:function(a){var b,c,e=[],f;if(!l(a)){I(a)||
(a=x.call(arguments));f=a.itemIsObject;for(b=0;b<a.length;b++)c=a[b],e.push(f||!I(c)?a instanceof this?this:new this(c):this.apply(null,c))}return e},extend:function(a,b){var c,e=this;c=a&&a.hasOwnProperty("constructor")?a.constructor:function r(){var a;if(!(this instanceof r))return a=new r(da),r.apply(a,arguments);if(arguments[0]===da)return this;e.apply(this,arguments);return this};m(c,e,b);var f=function(){this.constructor=c};f.prototype=e.prototype;c.prototype=new f;a&&m(c.prototype,a);c.__super__=
e.prototype;return c}});m(h,{Class:Za,util:P={toPhysicalPath:G=function(a,b){for(var c,e="",f="",g;c=rc.exec(a);)a=R.rightContext,f=R.leftContext,"."==c[0]?e?(e==F&&(b&&!sa[f])&&(g=f.replace(Ja,Ka),l(s.get(g))||(sa[f]={})),e=e+"."+f):e=f:(e?(c=(e?e.replace(sc,Ub):e)+"#"+f,g=e+"."+f):g=f?c=f:c="",e=F+(c?"."+c:""),b&&(!sa[c]&&e!=F&&!l(s.get(g)))&&(sa[c]={}));return!a?e:e?e+"."+a:a},toLogicalPath:U=function(a){var b;return a===F?"*":(b=ib.exec(a))?(a=R.rightContext,b=b[1].replace(Ja,Ka),U(b+"*"+a)):
a},mergePath:A=function(a,b,c){if("_"==b)return"_";if("_"==a)if(b&&b.startsWith("/"))a="";else return"_";a=G(a);if(!l(b)&&null!==b&&(b+="",b.startsWith("/")))return b.substr(1);l(c)&&(c=!0);c&&(b&&a&&!Jb.test(b))&&(b="."+b);if(!b||"."==b)return a;if(Jb.test(b)){if(c=pc.exec(b)){b=1+(c[1]?c[1].length:0);for(var e=R.rightContext;b;)a=lb(a),b--;return e?a?a+c[2]+e:e:"*"===c[2]?a+"*":a}if(c=qc.exec(b))return A(hb(a),c[1])}else return b;return a+b},isUndefined:l=function(a){return a===p},isPrimitive:ma=
function(a){return null===a||typeof a in kc},isString:n=function(a){return"string"===typeof a},isObject:t=function(a){return"object"===g.type(a)},isBoolean:Y=function(a){return"boolean"===typeof a},toTypedValue:Fa=function(a){if(n(a)){a=g.trim(a);try{a="true"===a?!0:"false"===a?!1:"null"===a?null:"undefined"===a?p:Ya(a)?parseFloat(a):oc.test(a)?g.parseJSON(a):a}catch(b){}}return a},isPromise:na=function(a){return!(!a||!a.promise||!a.done||!a.fail)},clearObj:Kb=function(a){if(ma(a))return null;for(var b in a)mc.call(a,
b)&&(a[b]=Kb(a[b]));return a},clone:function(a,b){return ma(a)?a:I(a)?a.slice(0):q(a)?a:m(!!b,{},a)},local:function(a,b){if(1==arguments.length)return JSON.parse(Wa.getItem(a));l(b)?Wa.removeItem(a):Wa.setItem(a,JSON.stringify(b))},toString:function(a){return null===a||a===p?"":""+a},encodeHtml:function(a){var b=ka.createElement("div");b.appendChild(ka.createTextNode(a));return b.innerHTML}},onAddOrUpdateNode:function(a){return a?($.push(a),this):$},onDeleteNode:function(a){return a?(Ga.push(a),this):
Ga},options:L});var Ga=[function(a){var b,c,e=U(a);for(b in Q)kb(a,b);for(b in Q)b.startsWith(a)&&delete Q[b];for(c in sa)a=F+"."+c,b=U(a),(b==e||b.startsWith(e+"*")||b.startsWith(e+"."))&&s.del(a)}];g(["get","set","del","extend"]).each(function(a,b){h[b]=function(){return s[b].apply(s,x.call(arguments))}});s=h();fa.hmData=function(a,b){var c=this.data("hmData");if(0===arguments.length)return c;if(1===arguments.length)return c&&c[a];l(c)&&this.data("hmData",c={});c[a]=b};var W,ca=/[ ]+/,qb=/\*\.$/,
Xb=/\.|\*/g,B,vc=0,wc=/init(\d*)/,ya=["get","set","convert","finalize","initialize"];va.prototype={constructor:va,isDependent:function(){return!this.publisher.path.startsWith(this.originalPublisher.path)},stopPropagation:function(){this.isPropagationStopped=H},stopImmediatePropagation:function(){this.isCascadeStopped=this.isPropagationStopped=this.isImmediatePropagationStopped=H},stopCascade:function(){this.isCascadeStopped=H},error:function(){this.hasError=H},abort:rb,isCascadeStopped:aa,isPropagationStopped:aa,
isImmediatePropagationStopped:aa,isAborted:aa,hasError:aa,level:0};u=function(a,b,c,e,f){e=new va(a,b,c,e,f);pb(e);if(!e.isPropagationStopped()&&e.publisher.path){e.isDependent()&&(e.originalPublisher.path=e.publisher.path);do e.publisher.path=e.publisher.pathContext(),e.level++,e.type=e.originalType+"."+e.level,pb(e);while(!e.isPropagationStopped()&&e.publisher.path)}e.type=c;e.originalPublisher.path=b;e.publisher.path=a;return e};var $a=function(a,b){n(a)&&(a=G(a));for(var c=[],e=0,f;e<Z.length;e++)f=
Z[e],b(f,a)&&c.push(f);return c},Z=[];B={getByPublisher:function(a){return $a(a,function(a,c){return a.publisher==c})},getBySubscriber:function(a){return $a(a,function(a,c){return a.subscriber==c})},getBy:function(a){return $a(a,function(a,c){return a.subscriber==c||a.publisher==c})},getAll:function(){return Z},add:function(a,b,c,e){if(n(b))for(var f=c.split(ca),g=0;g<f.length;g++){var h=this.special[f[g]];h&&h.setup&&h.setup(a,b)}Z.push({publisher:b,subscriber:a,eventTypes:c,handler:e})},removeBy:function(a){var b,
c,e,f=[];for(b=Z.length-1;0<=b;b--)if(e=Z[b],c=e.handler,a===e.publisher||a===e.subscriber||n(a)&&(n(e.publisher)&&e.publisher.startsWith(a+".")||n(e.subscriber)&&e.subscriber.startsWith(a+".")))n(e.publisher)||(c.delegateSelector?g(e.publisher).undelegate(c.delegateSelector,e.eventTypes,ea):g(e.publisher).unbind(e.eventTypes,ea)),f.push(Z.splice(b,1)[0]);for(b=f.length-1;0<=b;b--)if(e=f[b],n(e.publisher)){var k=e.eventTypes.split(ca);for(a=0;a<k.length;a++)(c=this.special[k[a]])&&c.teardown&&c.teardown(e.subscriber,
e.publisher)}},special:{}};m(h,{trigger:u,subscription:B,sub:function(a,b,c,e,f,k){a instanceof h&&(a=a.path);b instanceof h&&(b=b.path);n(a)&&a.startsWith("$")&&(a=g(a.substr(1)));if(a&&a.jquery)if(!a.length&&!a.selector)a=null;else{a.each(function(a,g){h.sub(g,b,c,e,f,k)});return}n(b)&&b.startsWith("$")&&(b=g(b.substr(1)));if(b&&b.jquery)b.each(function(b,g){h.sub(a,g,c,e,f,k)});else{if(!b&&""!==b)throw"publisher can not be null";if(!c)throw"eventTypes can not be null";if("_"===a||"null"==a||null===
a)a=p;"_"===f&&(f=p);var r=n(b),j=n(a);ba.mark(b);ba.mark(a);r&&(b=G(b));j&&(a=G(a));if(r){var l=b,m=c,s=a,q=e,r=f,w,ab,y;y=m.split(" ");for(var D=0;D<y.length;D++)if(j=wc.exec(y[D])){ab=y[D];w=+j[1];y.splice(D,1);m=y.join(" ");break}q=sb(q,l,s,r);m&&B.add(s,l,m,q);ab&&(m=function(){var a=new va(l,l,ab);wa(K(s),q,a)},w?T(m,w):m())}else{w=b;r=c;j=a;y=e;var D=f,t;t=r.split(" ");t.contains("init")&&(m=!0,r=t.remove("init").join(" "));y=sb(y,w,j,D);D={handler:y,subscriber:j};r?(r=ob(r,w,j),k?(y.delegateSelector=
k,g(w).delegate(k,r,D,ea)):g(w).bind(r,D,ea),B.add(j,w,r,y),m&&(k?g(w).find(k).trigger(r):g(w).trigger(r))):m&&(g(w).one("init",D,ea),g(w).trigger("init"))}}},handle:function(){return this.sub.apply(this,[null].concat(x.call(arguments)))},workflow:function(a,b){if(t(a))for(var c in a)W[c]=tb(a[c]);else{if(l(a))return W;if(l(b))return W[a];W[a]=tb(b);return W[a]}},activity:{initialize:{},get:{getMember:mb,getOriginal:function(a){return a.originalPublisher.get()},fakeGet:function(){return da}},set:{setMember:nb,
fakeSet:g.noop},convert:{toString:P.toString,toTypedValue:P.toTypedValue,toNumber:function(a){return+a},toDate:function(a){return new Date(a)}},finalize:{}}});W={change:{get:function(a){s.change(a.handler.options)}},saveLocal:{get:function(a){var b=a.publisher.path;T(function(){h(b).saveLocal()},1)}}};var ba={getId:function(a){return g(a).hmData("viewId")},unMark:function(a){g(a).hmData("viewId",p)},mark:function(a){t(a)&&!g(a).hmData("viewId")&&g(a).hmData("viewId",++vc)}};h.onDeleteNode(ub);m(Na,
{trigger:function(a,b,c,e){if(!arguments.length)throw"missing arguments";3>=arguments.length&&(e=c,c=b,b=a,a="");var f=this.physicalPath(a);u(f,f,b,c,e);return this},change:function(a){var b=this.physicalPath(a);a=this.get(a);u(b,b,"afterUpdate",a,a);return this},sub:function(a,b,c,e,f){h.sub(this.path,a,b,c,e,f);return this},handle:function(a,b,c,e){h.sub(null,this,a,b,c,e);return this},subBy:function(a,b,c,e,f){h.sub(a,this.path,b,c,e,f);return this},subsToMe:function(){return B.getByPublisher(this.path)},
subsFromMe:function(){return B.getBySubscriber(this.path)},subs:function(){return B.getBy(this.path)},mapEvent:function(a,b,c){c=c||H;h.handle(this.path,a,function(a){c.call(this,a)&&a.publisher.trigger(b,a.proposed,a.removed)});return this},cacheable:function(a){h.handle(this.getPath(a),"init after*","*saveLocal");return this}});m(fa,{sub:function(a,b,c,e,f){this.length&&h.sub(this,a,b,c,e,f);return this},handle:function(a,b,c,e){this.length&&h.sub(null,this,a,b,c,e);return this},subBy:function(a,
b,c,e,f){this.length&&h.sub(a,this,b,c,e,f);return this},subsToMe:function(){return B.getByPublisher(this[0])},subsFromMe:function(){return B.getBySubscriber(this[0])},subs:function(){return B.getBy(this[0])},renderView:function(a,b,c){h.sub(this,a,"init",b,c);return this},mapEvent:function(a,b,c,e){c?q(c)||(e=c,c=H):c=H;return this.handle(a,function(a){c.call(this,a)&&(a.type=b,a.eventData=e,a.publisher.trigger(a))})}});h.newJqEvent=function(a,b,c){if(t(a)){for(var e in a)h.newJqEvent(e,a[e][0],
a[e][1]);return this}var f=function(b){(!0===c||c.call(this,b))&&g(b.target).trigger(m({},b,{type:a,currentTarget:b.target}))};if(g.event.special[a])throw"event '"+a+"' has been defined";g.event.special[a]={setup:function(){g(this).bind(b,f)},teardown:function(){g(this).unbind(b,f)}};return this};var xc=g.cleanData;g.cleanData=function(a){g(a).each(function(){ub(this)});xc(a)};P.getUniqueViewEventTypes=ob;P._viewHandlerGateway=ea;var bc=/([!$]?)([\w \+\-\*\.]+?):([\w\W]+?)\s*(?:[;]\s*|$)/g,yc=/^([^|]+)(\|(.*))?$/,
zc=/\s*\|\s*/g;L.subsAttr="data-sub";L.autoParse=!0;var Zb=/_/g,$b=/-(\w)/g,Yb=/^data-/,ac=function(a,b){return b.toUpperCase()};X.prototype={_importBindings:function(){var a,b,c,e,f,g=this.bindings;for(a=0;a<g.length;a++)e=g[a],b=e.bindingName,c=yc.exec(e.value),e=c[1],f=c[3],c=ga[b],q(c)?(e=[c,this.elem,A(this.ns,e),this,Oa(this.options,f)],"runFirst"==b?this.context.runFirst=e:"runLast"==b?this.context.runLast=e:this.context.dynamicBindings.push(e)):n(c)&&new X(c,this,e,f)},_importSubscriptions:function(a){var b,
c,e,f,g,h=this[a];for(b=0;b<h.length;b++)c=h[b],f=c.eventTypes,c=c.value.split(zc),"sub"==a?(e=c[0],e=e.startsWith("$")?e:A(this.ns,e),g=this.elem):(e=this.elem,g=c[0],g=g.startsWith("$")?g:A(this.ns,g)),this.appendSub(g,e,f,c[1],Fa(Oa(this.options,c[2])),c[3])},appendSub:function(a,b,c,e,f,g){this.context.subscriptions.push({publisher:b,eventTypes:c,subscriber:a,handler:e,options:f,delegate:g})},prependSub:function(a,b,c,e,f,g){this.context.subscriptions.unshift({publisher:b,eventTypes:c,subscriber:a,
handler:e,options:f,delegate:g})},clearSubs:function(){this.context.subscriptions.splice(0,this.subscriptions.length)}};T(function(){g(function(){L.autoParse&&Pa(ka.documentElement)})},1);fa.parseSubs=function(){return this.each(function(){Pa(this)})};var Lb=h("*log",[]),ga={};m(h,{binding:S,log:function(a,b){a+="";Lb.push(b?"<div style='color:"+b+"'>"+a+"</div> ":a)},clearlog:function(){Lb.clear()}});S("runFirst",wb);S("runLast",wb);var ta={},O={},ua={},Mb={},ra={},Ra=ka.createElement("a"),dc=/,/,
cc=/\s+/g,fc=/\?/,Ac=/\.(\w+)$/,Bc=/(.+)\.\w+$/,Ba,Nb,Ob,V,J,ec=/^http[s]?:\/\/|^\//,Bb=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,Ca=Bb.exec(hc.href.toLowerCase())||[],ia="",qa="v",Cb,bb=[],cb=[],db=[],Ta,Pb={},Sa="",j=h.loader=function(a,b,c){if(l(b))return a?ra[a]:ra;n(b)||(c=b,b=null);c=Mb[a]=g.extend(!0,{},Mb[b],c);var e=g.extend(!0,{},c);g.each(["load","unload","url","depend"],function(a,b){var c=e[b];n(c)&&(c=Ob[b][c])&&(e[b]=c)});if(g.isPlainObject(e.load)){var f=e.load,k;for(k in f){c=
f;var h=k;n(c[h])&&(c[h]=V[h][c[h]])}var m=f.staticLoaded||V.staticLoaded.returnFalse,s=f.getSource||V.getSource.getTextByAjax,q=f.compile===p?V.compile.globalEval:f.compile,t=f.crossSiteLoad||V.crossSiteLoad.getScript,u=f.buildDependencies||V.buildDependencies.parseDependTag,w=f.buildUnload||V.buildUnload.parseUnloadTag;if(!q&&!t)throw"loader must implement at least one of compile, crossSiteLoad";e.load=function(a){var b=g.Deferred(),c=b.promise(),e;if(m(a))c.refCount="staticLoaded",b.resolve();
else{e=j.url(a);if(!q||f.byPassGetSource||Ab(e)){if(!t)throw"loader does not support cross domain loading";return t(a)}s(a).then(function(e){if(w){var f=w(e,a);f&&(N(a).unload=f)}u&&(f=u(a,e))&&J(a,f);var f=function(){var f=q&&q(a,e);T(function(){b.dontResolve||(b.resolve(f),delete c.defer)},5)},g=J(a);g?j.load(g).then(f,function(){b.reject(a);delete c.defer}):f()},function(){b.reject(a);delete c.defer});eb(b)||(c.defer=b)}return c}}if(!g.isFunction(e.load))throw"missing load function from loader";
ra[a]=g.extend({},ra[b],e)},Cc=Qa(cb),Dc=Qa(bb),Ec=Qa(db),eb=g.Deferred().isResolved?function(a){return a.isResolved()}:function(a){return"resolved"==a.state()};g.extend(j,{load:function(a,b,c){Y(a)||(c=b,b=a,a=!1);if(b)return a=a&&!g.isReady,b=xb(b,c),a&&(g.holdReady(!0),b.done(function(){g.holdReady()})),b.done(Dc).fail(Cc)},unload:function(a,b){var c,e;if(g.isFunction(a))b?db.remove(a):db.push(a);else if(n(a)&&(a=M(a)),1!=a.length)for(c=0;c<a.length;c++)j.unload(a[c]);else if(c=a[0],(e=N(c))&&
"staticLoaded"!=e.refCount){if(0===--e.refCount||b)if((e=e.unload||ha(c).unload)&&e(c),N(c,p),e=J(c))j.unload(e,b),J(c,p);Ec()}},url:function(a,b){if(t(a))for(var c in a)j.url(c,a[c]);else if(b===p){if(1==arguments.length){if(ta[a])return ta[a];c=ha(a);return Da(c&&c.url?c.url(a):c&&c.fileExt?Nb(a)+"."+c.fileExt:a)}delete ta[a]}else{c=j.url(a);var e=Da(b);c!=e&&((c=N(a))&&eb(c)?Db(a,function(){ta[a]=e}):ta[a]=e)}},depend:J=function(a,b){if(t(a))for(var c in a)J(c,a[c]);else if(b===p){if(1==arguments.length){c=
ua[a];var e=ha(a);return e&&e.depend?(e=e.depend(a))&&c?e+","+c:e?e:c:c}delete ua[a]}else if(!0===b){if(c=(c=J(a))&&M(c)){for(var e=[],f=0;f<c.length;f++)"module"!==j.fileExt(c[f])&&e.pushUnique(j.url(c[f])),e.merge(J(c[f],!0));return e}}else{var g;c=b;if(f=(e=ha(a))&&e.depend&&e.depend(a)){e=[];f=M(f);c=M(c);for(var h=0;h<c.length;h++)f.contains(c[h])||e.push(c[h]);g=e.length?e.join():null}else g=c;c=ua[a];gc(g,c)&&(e=N(a),c&&e&&eb(e)?Db(a,function(){ua[a]=g}):ua[a]=g)}},baseUrl:function(a){if(l(a))return Sa;
Sa=a.endsWith("/")?a:a+"/"},hash:function(a,b){arguments.length&&(ia=!0===a?g.now():a,qa=b!==p?b:qa||"v",Cb=new R("[?&]"+qa+"=[^&]*"));return""===ia?"":qa+"="+ia},methods:Ob={load:{cacheImage:function(a){var b=g.Deferred(),c=b.promise(),e=j.url(a);a=new Image;a=new Image;a.onload=function(){b.resolve(e)};a.onerror=function(){b.reject(e)};a.src=e;return c}},unload:{removeCssLinkTag:function(a){var b=Da(j.url(a));g("link").filter(function(){return this.href===b&&g(this).attr("loadedByloader")}).remove()}},
url:{assetId:function(a){return a},folder:function(a){var b=ha(a).fileExt,b=b?j.fileName(a)+"."+b:a;return j.fileExt(a)+"/"+b}},depend:{}},loadFilters:V={staticLoaded:{returnFalse:function(){return!1},hasScriptTag:function(a){return!!g("script").filter(function(){return pa(this.src)===pa(j.url(a))}).length}},getSource:{getTextByAjax:function(a){return g.ajax({url:j.url(a),dataType:"text",cache:!0})}},compile:{globalEval:function(a,b){return g.globalEval(b)},localEval:function(a,b){return eval(b)}},
crossSiteLoad:{getScript:function(a){var b=g.Deferred(),c=b.promise();c.defer=b;g.getScript(j.url(a)).then(function(){T(function(){b.dontResolve||(b.resolve(),delete c.defer)},5)},function(){b.reject();delete c.defer});return c}},buildUnload:{parseUnloadTag:function(a){return(a=Fc.exec(a))&&a[1]&&new Function(a[1])}},buildDependencies:{parseDependTag:function(a,b){var c=Gc.exec(b);return c&&c[1]||null}}},finders:Ta=[function(a){return Ba(a)},function(a){a=Ba(a);if(a=Pb[a])return a}],mapFileExtToLoader:function(a,
b){a=M(a);for(var c=0;c<a.length;c++)Pb[a[c]]=b},fileExt:Ba=function(a){return Ac.exec(a)[1]},fileName:Nb=function(a){return Bc.exec(a)[1]},define:function(a,b,c,e){g.isFunction(b)&&(e=c,c=b,b=null);var f,k=N(a);k?f=k.defer:(f=g.Deferred(),k=f.promise(),k.defer=f,N(a,k));k.defer.dontResolve=!0;var h=function(a){delete k.defer;k.unload=e;f&&f.resolve(c(a))};b?(J(a,b),j.load(b).done(h)):h();return k},done:function(a,b){b?bb.remove(a):bb.push(a)},fail:function(a,b){b?cb.remove(a):cb.push(a)},defaultLoader:"js"});
var Fc=/<@unload>([\w\W]+?)<\/@unload>/i,Gc=/<@depend>([\w\W]+?)<\/@depend>/i,Qb=g.noop;j("pack",{load:function(a){var b=g.Deferred(),c=j.depend(a);c?j.load(c).done(function(){b.resolve(a,Qb(a))}):b.resolve(a,Qb(a));return b.promise()},url:"assetId"});j("js",{load:{staticLoaded:"hasScriptTag"},fileExt:"js"});j("jsl","js",{load:{compile:"localEval"}});j("loader","js",{url:"folder"});j("css",{load:{staticLoaded:function(a){return!!g("link").filter(function(){return pa(this.href)===pa(j.url(a))&&!g(this).attr("loadedByloader")}).length},
crossSiteLoad:function(a){var b=g.Deferred();g("<link href='"+j.url(a)+"' rel='stylesheet' type='text/css' loadedByloader='1' />").load(function(){b.resolve(a)}).appendTo("head");return b.promise()},compile:null},unload:function(a){var b=Da(j.url(a));g("link").filter(function(){return this.href===b&&g(this).attr("loadedByloader")}).remove()},fileExt:"css"});j("image",{load:"cacheImage",noRefCount:!0});j.mapFileExtToLoader("jpg,png,bmp,gif","image");var C,Hc=/^apk\.([^.]+)(\.?)(.*)$/,Ic=/^\*/,Ea={},
Ua={initialize:"*templateOptions",get:"get",convert:"*template",set:"html",finalize:"*parseSubs"};h.activity.initialize.templateOptions=function(a,b,c,e){if(n(e))e=e.split(","),c.templateId=g.trim(e[0]),c.wrapDataInArray="true"==g.trim(e[1]),c.engineName=e[2];else if(t(e)&&e.templateId)m(c,e);else if(!(c.templateId=b.hmData("embeddedTemplate")))if(a=g.trim(b.html()))a=a.replace(Jc,Kc),c.templateId="__"+g.uuid++,C.compile(c.templateId,a),b.hmData("embeddedTemplate",c.templateId),b.empty();else throw"missing template";
};var Jc=/&lt;|&gt;/g,Lc={"&lt;":"<","&gt;":">"},Kc=function(a){return Lc[a]||""};Fb.prototype.get=function(){var a=this.e.publisher;return a.get.apply(a,arguments)};h.activity.convert.template=function(a,b){if(a&&(I(a)&&a.length||!I(a))){var c,e,f=b.handler;f.templateId?(c=f.templateId,e=f.wrapDataInArray?[a]:a):(c=a,e={});if(!c)return"";var k=e;e=new Fb(b);var h=Gb(f.engineName,c);c=g.trim(c);var j=c.replace(Ic,"");if(h.isTemplateLoaded(j))c=h.render(j,k,e);else if(h.renderAsync)c=h.renderAsync(j,
k,e);else{var l=g.Deferred(),f=m(!0,{},e.e),q=m(!0,{},f.publisher),p=m(!0,{},e);f.publisher=q;p.e=f;C.load(c).done(function(){var a=h.render(j,k,p),b=g(a);l.resolve(b.selector||!b.length?a:b)});c=l.promise()}if(na(c))return c;n(c)&&(c=g.trim(c));return g(g("<div />").html(c)[0].childNodes)}return""};h.activity.finalize.parseSubs=function(a){g(a).parseSubs()};h.workflow({tmpl:Ua,include:Eb("get","replaceWith")});S({tmpl:"!init:.|*tmpl",tmplOnChange:"!init after*.:.|*tmpl",tmplOnChildChange:"!init after*. after*.1:.|*tmpl",
tmplOnAnyChange:"!init after*:.|*tmpl",include:"!init:.|*include"});fa.tmpl=function(a,b,c){b=b||"";q(c)&&(c={finalize:c});return this.renderView(b,c?m({},Ua,c):"*tmpl",a)};fa.include=function(a,b,c){q(c)&&(c={finalize:c});return this.renderView(b,c?m({},h.workflow("replace"),c):"*replace",a)};h.template=C={defaultEngine:"",engineAdapter:function(a,b){if(!a)return Ea;if(!b)return Ea[a];b.isTemplateLoaded=b.isTemplateLoaded||H;Ea[a]=b;C.defaultEngine=a},load:function(a){return j.load(a.endsWith(".html")?
a:a+".template")},compile:function(a,b,c){return Gb(c).compile(a.endsWith(".template")?j.fileName(a):a,b)},newTemplateHandler:Eb,templateIdToUrl:function(a){var b=Hc.exec(a);return b?"apk/"+b[1]+"/"+(b[3]||"main")+".html":a.endsWith(".html")?a:a.split(".")[0]+".html"}};j("template",{load:{compile:function(a,b){var c=g(b),e=!1;c.each(function(){if("SCRIPT"==this.tagName)return e=!0,!1});e?c.each(function(){if("SCRIPT"==this.tagName){var a=g(this);C.compile(this.id,a.html(),a.attr("type")||C.defaultEngine)}}):
C.compile(a,b,C.defaultEngine)},buildDependencies:"parseDependsTag"},url:function(a){return C.templateIdToUrl(j.fileName(a))}});j("html","template",{url:function(a){return a}});if(g.render&&g.templates){var fb;C.engineAdapter("jsrender",fb={render:function(a,b,c){g.render[a]||this.compile(a,ka.getElementById(a).innerHTML);return g.render[a](b,c)},compile:function(a,b){g.templates(a,{markup:b,debug:fb.templateDebugMode,allowCode:fb.allowCodeInTemplate})},isTemplateLoaded:function(a){return!!g.render[a]||
!!ka.getElementById(a)},templateDebugMode:!1,allowCodeInTemplate:!0});var Rb=g.views.tags;Rb({ts:function b(){return b.enabled?"<span style='color:red' data-sub='show:/*ts'>updated on:"+(+new Date+"").substring(7,10)+"</span>":""},get:function(){var b=this.ctx.e.publisher;return b.get.apply(b,arguments)},prop:function(){var b=this.tagCtx.view.index;l(b)&&(b=this.ctx.e.publisher.count()-1);b=this.ctx.e.publisher.cd(b);return b.get.apply(b,arguments)},fixedRowId:function(){return"/"+this.ctx.modelPath+
".table."+this.ctx.e.publisher.itemKey(this.tagCtx.view.data)},rowId:function(){var b=this.tagCtx.view.index,c=this.ctx.modelPath;l(b)&&(b=this.ctx.e.publisher.count()-1);return"/"+c+"."+b},modelPath:function(){return"/"+this.ctx.modelPath}});Rb.ts.render.enabled=!0;h("*ts",!1)}var z=E.Handlebars;l(z)||(h.template.engineAdapter("handlebars",{render:function(b,c,e){return z.partials[b](c,{data:{renderContext:e}})},compile:function(b,c){z.registerPartial(b,z.compile(c))},isTemplateLoaded:function(b){return!!z.partials[b]}}),
z.registerHelper("modelPath",function(b){return b.data.renderContext.modelPath}),z.registerHelper("rowId",function(b){return"/"+b.data.renderContext.modelPath+"."+b.data.index+";"}),z.registerHelper("fixedRowId",function(b){b=b.data.renderContext;return"/"+b.modelPath+".table."+b.e.publisher.itemKey(this)}),z.registerHelper("get",function(){var b=arguments,c=b.length-1,e=b[c].data.renderContext;return e.get.apply(e,x.call(b,0,c))}),z.registerHelper("prop",function(){var b=[].slice,c=arguments,e=c.length-
1,f=c[e].data,f=f.renderContext.e.publisher.cd(f.index);return f.get.apply(f,b.call(c,0,e))}),g(function(){g("script[type=handlebars]").each(function(){z.registerPartial(this.id,z.compile(g(this)[0].innerHTML))})}));var ja=[{name:"textBoxOrDropDown",initialize:function(b,c){c&&("SELECT"==b[0].tagName?b.children().each(function(){if(this.value==c)return g(this).attr("selected","selected"),!1}):b.attr("value",c))},get:function(b){return b.val()},set:function(b,c){b.val()!==c&&b.val(c)},match:H},{name:"checkbox",
initialize:function(b,c){c&&b.attr("checked","checked")},get:function(b){b=b[0];var c=b.value;return"true"==c?!0:"false"==c?!1:"on"!==c?c:b.checked},set:function(b,c){var e=b[0];e.checked=Y(c)?c:c==e.value},match:function(b){return b.is(":checkbox")}},{name:"radio",initialize:function(b,c){c==b[0].value&&b.attr("checked","checked")},get:function(b,c){if("resetVal"==c.type&&!c.publisher.attr("checked"))c.abort();else{var e=b[0],f=e.value;return"true"==f?!0:"false"==f?!1:"on"!==f?f:e.checked}},set:function(b,
c,e){b=b[0];b.name||(b.name=e.publisher.path);b.checked=P.toString(c)==b.value},match:function(b){return b.is(":radio")}},{name:"listBox",initialize:function(b,c){b.children().each(function(){c.contains(this.value)&&g(this).attr("selected","selected")})},get:function(b){var c=[];b.children("option:selected").each(function(){c.push(this.value)});return c.length?c:null},set:function(b,c){b.children().each(function(){this.selected=!(!c||!c.contains(this.value))})},match:function(b){return b.is("select[multiple]")}}];
h.activity.get.getViewValue=function(b){return b.handler.getViewValue(b.publisher,b)};h.activity.set.setViewValue=function(b,c){return c.handler.setViewValue(this,b,c)};h.workflow({updateViewValue:{initialize:function(b,c,e,f){Hb(b,c,e,f,"set")},get:"get",set:"*setViewValue"},updateModelValue:{initialize:function(b,c,e,f){Hb(c,b,e,f,"get")},get:"*getViewValue",set:"set"}});h.valueAdapter=function(b){if(b)ja.push(b);else return ja};S({val:function(b,c,e,f){var g,h,j;(f=f||"")?(f=f.split(","),h=f[0]||
"change",g=f[1],j=f[2]):h="change";(!g||"view"==g)&&e.appendSub(b,c,"init1 after*","*updateViewValue",j);(!g||"model"==g)&&e.prependSub(c,b,h+" resetVal","*updateModelValue",j)}});L.confirmMessage="Are you sure?";h.activity.get.compareTruthy=function(b){var c=b.handler.options;b=b.publisher;return l(c)?!b.isEmpty():b.compare(c)};h.activity.initialize.extractClass=function(b,c,e,f){b=f.split(",");e.className=b[0];e.options=b[1]};var Sb={options:["!init after*:.|*options",{get:function(b){var c=b.handler.options,
e=this.val();this.children("option[listItem]").remove().end().append(function(){var e="";g(b.publisher.get()).each(function(){e+="<option listItem='1' value='"+c.value(this)+"'>"+c.name(this)+"</option>"});return e}).val(e);this.val()!==e&&g(this.trigger("change"))},initialize:function(b,c,e,f){if(f){b=f.split(",");var g=b[0],h=b[1]||b[0];e.options={name:function(b){return b[g]},value:function(b){return b[h]}}}else e.options={name:function(b){return b.toString()},value:function(b){return b.toString()}}}}],
show:["!init after*:.|*show",{get:"*compareTruthy",set:function(b){this[b?"show":"hide"]()}}],hide:["!init after*:.|*hide",{get:"*compareTruthy",set:function(b){this[b?"hide":"show"]()}}],enable:["!init after*:.|*enable",{get:"*compareTruthy",set:function(b){this.attr("disabled",!b)}}],disable:["!init after*:.|*disable",{get:"*compareTruthy",set:function(b){this.attr("disabled",b)}}],addClass:["!init after*:.|*addClass",{initialize:"*extractClass",get:"*compareTruthy",set:function(b,c){this[b?"addClass":
"removeClass"](c.handler.className)}}],removeClass:["!init after*:.|*removeClass",{initialize:"*extractClass",get:"*compareTruthy",set:function(b,c){this[b?"removeClass":"addClass"](c.handler.className)}}],toggleClass:["!init after*:.|*toggleClass",{get:function(b){var c,e,f=b.publisher.get(),g=b.handler.options;g&&(g.startsWith("!")&&(e=!0,g=g.substr(1)),c=f^e?"addClass":"removeClass");if("init"==b.type)if(g)this[c](g);else this.addClass(f);else if(g)this[c](g);else this.removeClass(b.removed).addClass(f)}}],
focus:["!init after*:.|*focus",{get:"*compareTruthy",set:function(b){if(b){var c=this;T(function(){c.focus().select()},1)}}}],count:["!init after*:.|*count",function(b){b=b.publisher.get();this.text("length"in b?b.length:b)}],dump:["!init *:.|*dump",function(b){b.type.startsWith("before")||this.html("<span style='color:red'>"+b.publisher.path+" : "+b.publisher.toJSON()+"</span>")}],alert:["$click:.|*alert",function(b){ic(l(b.handler.options)?this.get():b.handler.options)}],log:["$click:.|*log",function(b){h.log(l(b.handler.options)?
this.get():b.handler.options)}],preventDefault:["$click:_|*preventDefault",function(b){b.preventDefault()}],stopPropagation:["$click:_|*stopPropagation",function(b){b.stopPropagation()}],confirm:[function(b,c,e,f){h.sub(c,b,"click","*confirm",f)},function(b){var c=l(b.handler.options)?this&&this.path&&this.get&&this.get()||L.confirmMessage:b.handler.options;jc(c)||(b.stopImmediatePropagation(),b.preventDefault&&b.preventDefault())}],setTo:["$click:.|*setTo",{initialize:function(b,c,e,f){e.setTo=Fa(f)},
get:function(b){this.set(b.handler.setTo)}}],"0":["$click:.|*0",function(){this.set(0)}],emptyString:["$click:.|*empty",function(){this.set("")}],"null":["$click:.|*null",function(){this.set(null)}],"true":["$click:.|*true",function(){this.set(!0)}],"++":["$click:.|*++",function(){this.set(this.get()+1)}],"--":["$click:.|*--",function(){this.set(this.get()-1)}],"false":["$click:.|*false",function(){this.set(!1)}],toggle:["$click:.|*toggle",function(){this.set(!this.get())}],sortItems:["$click:.|*sortItems",
{initialize:function(b,c,e,f){f=(f||"")&&f.split(",");e.by=f[0];e.asc=!!f[1]},get:function(b){b=b.handler;this.sort(b.by,b.asc);b.asc=!b.asc}}],clear:["$click:.|*clear",function(){this.clear()}],del:["$click:.|*del;confirm:_|_Do you want to delete this item?",function(){this.del()}]},Ha;for(Ha in Sb){var Tb=Sb[Ha];S(Ha,Tb[0]);h.workflow(Ha,Tb[1])}S({caption:function(b,c,e,f){g(b).prepend("<option value=''>"+(f||h.get(c)||"")+"</option>")},autofocus:function(b){T(function(){g(b).focus()},1)},mapEvent:function(b,
c,e,f){f=f.split(",");g(b).mapEvent(f[0],f[1],f[2])},mapClick:function(b,c,e,f){f=f.split(",");g(b).mapEvent("click",f[0],f[1])},logPanel:function(b,c,e){g(b).css("list-style-type","decimal").css("font-family","monospace, serif");e.appendSub(b,"*log","init",function(b){b=b.publisher.get();for(var c=0;c<b.length;c++)this.append("<li>"+b[c]+"</li>")});e.appendSub(b,"*log","afterCreate.1",function(b){this.append("<li>"+b.originalPublisher.raw()+"</li>")});e.appendSub(b,"*log","afterCreate",function(){this.empty()})},
clearlog:"clear:/*log",enableLater:"!after*:.|*enable",disableLater:"!after*:.|*disable",html:"!init after*:.|get html *toString",text:"!init after*:.|get text *toString",removeIfDel:"!duringDel:.|*fakeGet remove",emptyIfDel:"!duringDel:.|*fakeGet empty"});h.newJqEvent({enter:["keyup",function(b){return 13===b.keyCode}],esc:["keyup",function(b){return 27===b.keyCode}],ctrlclick:["click",function(b){return b.ctrlKey}]})})(jQuery,window);
